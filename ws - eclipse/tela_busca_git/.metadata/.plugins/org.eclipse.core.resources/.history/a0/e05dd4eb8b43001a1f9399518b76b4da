package shell;

import java.io.*;

public class ProcessBuilder {

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		ProcessBuilder processBuilder = new ProcessBuilder();
		processBuilder.command("powershell.exe", "#!/usr/bin/env bash\r\n" + 
				"USER=IgorPompeoTavares\r\n" + 
				"DATA_INICIO=$(date -d 'yesterday' '+%Y/%m/%d') # Data inicio precisa ser menor que a FIM\r\n" + 
				"DATA_FIM=$(date +'/%Y/%m/%d')\r\n" + 
				"ARQUIVO_LOG=\"C:/Users/$USER/Desktop/git_log.log\"\r\n" + 
				"\r\n" + 
				"# Salva log em um arquivo\r\n" + 
				"git log --pretty='format:%h' --after=$DATA_INICIO --before=$DATA_FIM > \"C:/Users/$USER/Desktop/hash.log\"\r\n" + 
				"# Criando vetor com os hash que deseja validar\r\n" + 
				"declare -a vetor_commit\r\n" + 
				"declare -a vetor_arquivos\r\n" + 
				"mapfile vetor_commit < C:/Users/$USER/Desktop/hash.log\r\n" + 
				"# Criando um loop for para varrer o vetor\r\n" + 
				"echo \"COMEÇO\"\r\n" + 
				"echo \"\" > $ARQUIVO_LOG\r\n" + 
				"\r\n" + 
				"function separator(){\r\n" + 
				"    echo $1 >> $ARQUIVO_LOG\r\n" + 
				"}\r\n" + 
				"\r\n" + 
				"\r\n" + 
				"for i in \"${vetor_commit[@]}\"; do\r\n" + 
				"# Comando que faz a busca no Git e traz os dados do responsável pelo commit\r\n" + 
				"    echo \"PROCESSANDO HASH: $i\"\r\n" + 
				"    separator \"HASH: $i\"\r\n" + 
				"\r\n" + 
				"    separator \"=================================================================================\"\r\n" + 
				"\r\n" + 
				"\r\n" + 
				"    separator \" ########### LOG ########### \"\r\n" + 
				"\r\n" + 
				"    git log --graph --pretty='format:%n Message: %B %n User:  %an %n Email: %ae %n Date: %ai %n ' -n 1 $i >> $ARQUIVO_LOG\r\n" + 
				"\r\n" + 
				"    separator \"########### ARQUIVOS ###########\"\r\n" + 
				"\r\n" + 
				"    git diff-tree --no-commit-id --name-only -r $i >> $ARQUIVO_LOG\r\n" + 
				"\r\n" + 
				"    separator \"____________________________________________________________________________________________\"\r\n" + 
				"\r\n" + 
				"\r\n" + 
				"done\r\n" + 
				"echo \"FIM\"");
	}

	private void command(String string, String string2) {
		// TODO Auto-generated method stub	
	}

}
